<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Understanding Null-Hypothesis Significance Testing | Introduction to Statistics for Experimental Psychology with R</title>
<meta name="author" content="Henrik Singmann">
<meta name="description" content="In Chapters 5 and 6 we have discussed how to perform and interpret null hypothesis significance tests (NHST) in R. In the present chapter we will provide further background on how NHST works. How...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 7 Understanding Null-Hypothesis Significance Testing | Introduction to Statistics for Experimental Psychology with R">
<meta property="og:type" content="book">
<meta property="og:description" content="In Chapters 5 and 6 we have discussed how to perform and interpret null hypothesis significance tests (NHST) in R. In the present chapter we will provide further background on how NHST works. How...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Understanding Null-Hypothesis Significance Testing | Introduction to Statistics for Experimental Psychology with R">
<meta name="twitter:description" content="In Chapters 5 and 6 we have discussed how to perform and interpret null hypothesis significance tests (NHST) in R. In the present chapter we will provide further background on how NHST works. How...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="include/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Statistics for Experimental Psychology with <code>R</code></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="role-of-statistics-in-the-research-process.html"><span class="header-section-number">1</span> Role of Statistics in the Research Process</a></li>
<li><a class="" href="chapter-1-quiz.html">Chapter 1: Quiz</a></li>
<li><a class="" href="research-designs.html"><span class="header-section-number">2</span> Data and Research Designs</a></li>
<li><a class="" href="chapter-2-quiz.html">Chapter 2: Quiz</a></li>
<li><a class="" href="tidyverse-intro.html"><span class="header-section-number">3</span> Short Introduction to R and the tidyverse</a></li>
<li><a class="" href="tidyverse-exercises.html">tidyverse: Example, Quiz, and Exercises</a></li>
<li><a class="" href="ggplot2-intro.html"><span class="header-section-number">4</span> Data Visualisation with ggplot2</a></li>
<li><a class="" href="ggplot-exercises.html">ggplot2: Example, Quiz, and Exercises</a></li>
<li><a class="" href="standard1.html"><span class="header-section-number">5</span> The Standard Approach for One Independent Variable</a></li>
<li><a class="" href="case-study-laptop.html"><span class="header-section-number">6</span> Case Study: More Results from Note Taking Studies</a></li>
<li><a class="" href="standard-approach-exercises.html">Standard Approach for One IV: Quiz and Exercises</a></li>
<li><a class="active" href="understanding-nhst.html"><span class="header-section-number">7</span> Understanding Null-Hypothesis Significance Testing</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/singmann/stats_for_experiments">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="understanding-nhst" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Understanding Null-Hypothesis Significance Testing<a class="anchor" aria-label="anchor" href="#understanding-nhst"><i class="fas fa-link"></i></a>
</h1>
<p>In Chapters <a href="standard1.html#standard1">5</a> and <a href="case-study-laptop.html#case-study-laptop">6</a> we have discussed how to perform and interpret null hypothesis significance tests (NHST) in <code>R</code>. In the present chapter we will provide further background on how NHST works. How do we actually test the null hypothesis?</p>
<p>To understand the statistical logic behind NHST, we first need to introduce a few concepts: The normal distribution, probability, and the sampling distribution of the null hypothesis. Once we have introduced these, we can show how NHST is actually performed. However, as in the previous chapters, this will not be a mathematically rigorous introduction, but rather a conceptual introduction that should equip you with the correct intuitions on how NHST works. For readers interested in a more traditional introduction in psychology I recommend <span class="citation">Baguley (<a href="references.html#ref-baguleySeriousStatsGuide2012" role="doc-biblioref">2012</a>)</span> or <span class="citation">Howell (<a href="references.html#ref-howellStatisticalMethodsPsychology2013" role="doc-biblioref">2013</a>)</span>. For a fully rigorous treatment see <span class="citation">Cox (<a href="references.html#ref-coxPrinciplesStatisticalInference2006" role="doc-biblioref">2006</a>)</span> or <span class="citation">Pawitan (<a href="references.html#ref-pawitanAllLikelihoodStatistical2014" role="doc-biblioref">2014</a>)</span>.</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://afex.singmann.science/">"afex"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rvlenth/emmeans">"emmeans"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'emmeans' was built under R version 4.1.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/eclarke/ggbeeswarm">"ggbeeswarm"</a></span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span> </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="the-normal-distribution" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> The Normal Distribution<a class="anchor" aria-label="anchor" href="#the-normal-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>In Section <a href="ggplot2-intro.html#intro-histograms">4.6</a>, we have introduced the histogram as the preferred data visualisation technique for investigating the <em>distribution</em> of one variable. We have also discussed how to describe and interpret such a histogram. However, the distribution of a variable is not only important for exploratory data analysis, but plays a fundamental role in inferential statistics.</p>
<p>To understand the role of the distribution of a variable, let’s first define it. In statistics, a distribution is a mathematical function that tells us how probable different possible outcomes of a variable are. For example, if we knew the distribution of a variable of a continuous variable, we could calculate the probability of values within a certain range of the variable. In practice, we generally do not know the distribution of variable. Then, we can use a histogram which provides us with the corresponding descriptive statistics; the proportion of values that fall within a certain range of a variable.</p>
<p>To exemplify the concept of a distribution, let’s take a look at a few examples of empirical distributions shown via their histograms. Figure <a href="understanding-nhst.html#fig:sel-dist">7.1</a> shows the distributions of six selected variables. Panels (a) and (b) show variables we have already discussed, the overall memory scores from <span class="citation">Urry et al. (<a href="references.html#ref-urry2021" role="doc-biblioref">2021</a>)</span> in (a) and the sleep times from <span class="citation">Scullin, Gao, and Fillmore (<a href="references.html#ref-scullinBedtimeMusicInvoluntary2021" role="doc-biblioref">2021</a>)</span> in (b). Panels (c) and (d) show two different measures of risk preferences from the study of <span class="citation">Pedroni et al. (<a href="references.html#ref-pedroniRiskElicitationPuzzle2017" role="doc-biblioref">2017</a>)</span> briefly discussed in Section <a href="role-of-statistics-in-the-research-process.html#passing-thoughts">1.4.1</a>. The data in panel (c) shows risk preferences based on a lottery task <span class="citation">(i.e., a task similar to the task of <a href="references.html#ref-walasekHowMakeLoss2015" role="doc-biblioref">Walasek and Stewart 2015</a>)</span> and panel (d) shows data from a risk preference questionnaire in which participants had to indicate for a number of different scenarios how likely they were to perform a more or less risky option <span class="citation">(<a href="references.html#ref-hockeyEffectsNegativeMood2000" role="doc-biblioref">Hockey et al. 2000</a>)</span>. Panels (e) and (f) shows data set that come with the <code>openintro</code> <code>R</code> package <span class="citation">(<a href="references.html#ref-openintro2021" role="doc-biblioref">Çetinkaya-Rundel et al. 2021</a>)</span>. Panel (e) shows the birthweight of randomly sampled newborns in the US in 2014 (excluding babies with a weight below 1.5 kg; data set <code>births14</code>). Panel (f) shows the height of female US college students from the University of California, Los Angeles (UCLA, data set <code>speed_gender_height</code>).</p>
<div class="figure">
<span style="display:block;" id="fig:sel-dist"></span>
<img src="understanding-nhst_files/figure-html/sel-dist-1.png" alt="Distributions of six selected variables: (a) overall memory scores of 142 participants from @urry2021; (b) sleep times (in minutes) of the 48 participants in Experiment 2 of the earworm study of @scullinBedtimeMusicInvoluntary2021; (c) and (d) data from 1507 participants reported in @pedroniRiskElicitationPuzzle2017 investigating different risk preference measures, (c) results from an adaptive lottery task, (d) propensity for risk inventory questionnaire; (e) weights of a random sample of 1000 newborns in 2014 in the US in kg (children with a low birth weight below 1.5 kg are excluded); (f) heights of 878 female UCLA students (in cm)." width="100%"><p class="caption">
Figure 7.1: Distributions of six selected variables: (a) overall memory scores of 142 participants from <span class="citation">Urry et al. (<a href="references.html#ref-urry2021" role="doc-biblioref">2021</a>)</span>; (b) sleep times (in minutes) of the 48 participants in Experiment 2 of the earworm study of <span class="citation">Scullin, Gao, and Fillmore (<a href="references.html#ref-scullinBedtimeMusicInvoluntary2021" role="doc-biblioref">2021</a>)</span>; (c) and (d) data from 1507 participants reported in <span class="citation">Pedroni et al. (<a href="references.html#ref-pedroniRiskElicitationPuzzle2017" role="doc-biblioref">2017</a>)</span> investigating different risk preference measures, (c) results from an adaptive lottery task, (d) propensity for risk inventory questionnaire; (e) weights of a random sample of 1000 newborns in 2014 in the US in kg (children with a low birth weight below 1.5 kg are excluded); (f) heights of 878 female UCLA students (in cm).
</p>
</div>
<p>Even though these six variables in Figure <a href="understanding-nhst.html#fig:sel-dist">7.1</a> represent very different data – cognitive tasks, questionnaires, behavioural measures, and physiological variables – the shapes of the distributions are all relatively similar to each other. Each distributions exhibits roughly a bell shape<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;For panels (a) and (b) the pattern is more noisy compared to the other panels, because they contain considerably less data than the other panels.&lt;/p&gt;"><sup>59</sup></a>: data distributed symmetrically around a central mode, with most data near the mode and less data the further away we get from the mode (i.e., few “outliers”).</p>
<p>The most important theoretical distribution that has the same shape is the <em>normal distribution</em>. Because it is based on the work of German mathematician Carl Friedrich Gauss, it is also known as the <em>Gaussian distribution</em>. For all statistical methods discussed in this book, the normal distribution will play an important role as we will see below.</p>
<p>The normal distribution is defined via its mean (<em>m</em>) and standard deviation (<em>sd</em>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;More mathematically correct would be to say a normal distribution is defined through the mean and the variance. But because the standard deviation is (a) easier to interpret than the variance and (b) the square root of the variance, we will generally define it through mean and standard deviation.&lt;/p&gt;"><sup>60</sup></a> That is, once we know the mean and standard deviation of a normally distributed variable, we know how probably each value (or more correctly, interval of values) is. Figure <a href="understanding-nhst.html#fig:norm-dist">7.2</a> shows a plot of the normal distribution with <em>m</em> = 0 and <em>sd</em> = 1.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The normal distribution with &lt;em&gt;m&lt;/em&gt; = 0 and &lt;em&gt;sd&lt;/em&gt; = 1 is also known as the &lt;em&gt;standard normal distribution&lt;/em&gt;.&lt;/p&gt;"><sup>61</sup></a></p>
<div class="figure">
<span style="display:block;" id="fig:norm-dist"></span>
<img src="understanding-nhst_files/figure-html/norm-dist-1.png" alt="Probability density function (PDF) of the normal distribution with mean = 0 and standard deviation = 1." width="100%"><p class="caption">
Figure 7.2: Probability density function (PDF) of the normal distribution with mean = 0 and standard deviation = 1.
</p>
</div>
<p>What Figure <a href="understanding-nhst.html#fig:norm-dist">7.2</a> shows is called the <em>probability density function</em> or <em>PDF</em> of the normal distribution. This function (i.e., the black lines shown in the figure) can be calculated given a formula that we do not need to know.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;In &lt;code&gt;R&lt;/code&gt;, the corresponding function is &lt;code&gt;dnorm()&lt;/code&gt;, which gives the &lt;em&gt;density&lt;/em&gt; of the &lt;em&gt;normal distribution&lt;/em&gt;. If you want to take a look at the formula for it, you can find it on &lt;a href="https://en.wikipedia.org/wiki/Normal_distribution"&gt;Wikipedia&lt;/a&gt;. In general, Wikipedia provides very good formal information about most probability distributions.&lt;/p&gt;'><sup>62</sup></a> The height of the black line at a specific value of the variable – that is the density of that value – gives the <em>relative likelihood</em> of that value compared to the other values of the variable. In the next section below we will provide some further explanation of how to interpret the density function.</p>
<p>For now, the important take away message is that because we have the formula for the PDF of the normal distribution, if we knew that a variable follows the normal distribution, we could calculate the relative likelihood of any value of the variable. In other words, knowing the distribution of a variable allows us to express the <em>uncertainty</em> we have about the values of a variable. For example, for a variable that follows the normal distribution shown in Figure <a href="understanding-nhst.html#fig:norm-dist">7.2</a>, a value of around 1 is around 4 to 5 times more likely than a value around 2, because the density at 1 is around 4 to 5 times higher than the density at 2.</p>
<p>More generally, a <em>probability distribution</em> – of which the normal distribution is one example – provides a formal (i.e., mathematical) way to talk about variables for which the outcomes are not certain, but only known to an uncertain degree. We generally use the concept of <em>probability</em> to express this uncertainty numerically. Probability provides us with a way to handle the <em>randomness</em> inherent in the outcomes of the variable. In the next section we will provide a definition and examples of what exactly we mean with probability. Let’s first get back to the examples.</p>
<p>Visually, the shape of the normal distribution in Figure <a href="understanding-nhst.html#fig:norm-dist">7.2</a> looks similar to the observed distribution shapes shown in Figure <a href="understanding-nhst.html#fig:sel-dist">7.1</a>. The question is how well the empirical shapes agree with the theoretical shape of the normal distribution. As discussed above, the normal distribution is defined solely through the mean and the standard deviation. We can therefore add the theoretical PDF of the corresponding normal distribution to the empirical distribution. For this, we only need to calculate the mean and the standard deviation of the variables and can then calculate the corresponding normal distribution function. This is done in Figure <a href="understanding-nhst.html#fig:sel-dist-pdf">7.3</a> below.</p>
<div class="figure">
<span style="display:block;" id="fig:sel-dist-pdf"></span>
<img src="understanding-nhst_files/figure-html/sel-dist-pdf-1.png" alt="Same data as Figure \@ref(fig:sel-dist), but with corresponding normal distribution overlaid as a black line. The mean, *m*, and standard deviation, *sd*, for every variable is given in each panel." width="100%"><p class="caption">
Figure 7.3: Same data as Figure <a href="understanding-nhst.html#fig:sel-dist">7.1</a>, but with corresponding normal distribution overlaid as a black line. The mean, <em>m</em>, and standard deviation, <em>sd</em>, for every variable is given in each panel.
</p>
</div>
<p>On average, there is quite a large degree of agreement between the empirical distributions shown in the histograms and the normal distributions obtained shown as a line in Figure <a href="understanding-nhst.html#fig:sel-dist-pdf">7.3</a>. However, there are also some aspects of the empirical distributions for which the account of the normal distribution is lacking. For example, the empirical distribution in panels (a) and (b) are based on limited data compared to the other panels which each show distributions consisting of at least around 1000 observations. As a consequence, the empirical distributions in panels (a) and (b) are less smooth and more random than the other panels. One would hope that with more data for each of these panels the empirical distribution become smoother and the agreement with and normal distribution becomes better, but in the absence of more data this has to stay a hope (in statistics, we often call such hopes <em>assumptions</em>).</p>
<p>A more subtle disagreement can be seen in panels (c) and (e). In both cases, the empirical distribution is slightly asymmetric with a tail to one of the sides. Panel (c) is slightly right-skewed – that is, has a right tail – and panel (e) is slightly left-skewed and has a left tail. An alternative way to describe these patterns would be to say that there are some large outliers for panel (c) whereas there are some small outliers for panel (e). In any case, we see that as a consequence the symmetric normal distribution provides a misfit predicting more data than there is on the side of the skew/tail and predicting too little data on the opposite side.</p>
<p>Despite these patterns of misfit, the overall account of the normal distribution is at least satisfactory for the variables shown in Figure <a href="understanding-nhst.html#fig:sel-dist-pdf">7.3</a>. It seems appropriate to say these variables appear to be at least <em>approximately normally distributed</em>. This means the normal distribution is able to describe which values of the variables will appear with which likelihood. Consequently, we could use the normal distribution to predict how likely different values of the variable are in the future. Likewise, if we had observed a specific value from one individual, we could use the normal distribution and see how small are large this value is, relative to the full distribution.</p>
<div class="figure">
<img src="understanding-nhst_files/figure-html/sim_multi-1.png" alt="Simulated data sets from a normal distribution with mean = 0 and SD = 1 with different sample sizes (from N = 25 to N = 10,000). The black line shows the theoretical (i.e., true) probability density function." width="100%"><p class="caption">
(#fig:sim_multi)Simulated data sets from a normal distribution with mean = 0 and SD = 1 with different sample sizes (from N = 25 to N = 10,000). The black line shows the theoretical (i.e., true) probability density function.
</p>
</div>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_sim</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">simulated</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Simulated data"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:sim1"></span>
<img src="understanding-nhst_files/figure-html/sim1-1.png" alt="One simulated data set from a normal distribution with mean = 0, SD = 1, and N = 100." width="100%"><p class="caption">
Figure 7.4: One simulated data set from a normal distribution with mean = 0, SD = 1, and N = 100.
</p>
</div>
<p>Learning or assuming that a variable is (at least approximately) normally distributed not only permits predictions of future values of the variables, it also provides an extremely parsimonious description of the distribution of the variable. We only need to know the mean and the standard deviation of the variable and this is enough to fully specify the corresponding normal distribution function. More specifically, the mean and the standard deviation are the so-called <em>sufficient statistics</em> of the normal distribution. If we know these two values, we can perfectly describe the corresponding normal distribution. This means that in theory, additional information does not permit us to learn anything more about the distribution of the variable. Of course, in reality we do not really know if a variable is truly normally distributed, so we can practically always learn more if we get more data.</p>
<p>At this point, you might wonder why a number of rather different variables all appear to approximately follow the normal distribution. There is an interesting mathematical explanation for that, the <em>central limit theorem</em>. The central limit theorem is a mathematical proof showing that a variable will be normally distributed if it arises as a sum of many independent variables. For example, it seems sensible to assume that the physiological variables height and weight results as a sum of a number of independent variables, namely genetic and environmental influences. Some of these influences will have a positive and some will have a negative effect on weight and height. As a result, weight and height itself are normally distributed. Maybe more psychological variables, such as memory performance or risk preferences, are also the sum of different psychological or biological variables. This would explain why their distribution is also approximately normal.</p>
<p>Taken together, the importance of the normal distribution has both empirical and theoretical reasons. It is empirically successful and can adequately describe the observed distribution of many different variables. Theoretically it is appealing because it is the distribution that emerges if a variable results as the sum of many other variables, a property that is likely to hold for many biological and related variables.</p>
<p>However, not all variables can be described by the normal distribution. In contrast, the six variables in Figure <a href="understanding-nhst.html#fig:sel-dist-pdf">7.3</a> were selected to show a particularly strong agreement with the normal distribution. In reality, the distribution can look a lot less normal. And for some variables, the</p>
<ul>
<li><p>normal followes from sum of random bits Figure <a href="understanding-nhst.html#fig:sel-dist-pdf">7.3</a> demonstrates that for some variables it can make sense to assume they are normally distributed. Even though we of course don’t really know</p></li>
<li><p>not all normally distributed of course</p></li>
</ul>
<p>The variables shown <span class="citation">Freeman et al. (<a href="references.html#ref-freemanItemEffectsRecognition2010" role="doc-biblioref">2010</a>)</span></p>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="understanding-nhst_files/figure-html/unnamed-chunk-2-1.png" alt="Two variables (histograms) for which the corresponding normal distribution (black line) does not provide a good account. (a) Response time data from @freemanItemEffectsRecognition2010. (b) Number of days absent from school from 146 randomly sampled students in rural New South Wales, Australia, in a particular school year." width="100%"><p class="caption">
Figure 7.5: Two variables (histograms) for which the corresponding normal distribution (black line) does not provide a good account. (a) Response time data from <span class="citation">Freeman et al. (<a href="references.html#ref-freemanItemEffectsRecognition2010" role="doc-biblioref">2010</a>)</span>. (b) Number of days absent from school from 146 randomly sampled students in rural New South Wales, Australia, in a particular school year.
</p>
</div>
</div>
<div id="what-is-probability" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> What is Probability?<a class="anchor" aria-label="anchor" href="#what-is-probability"><i class="fas fa-link"></i></a>
</h2>
<div class="figure">
<span style="display:block;" id="fig:prob1"></span>
<img src="understanding-nhst_files/figure-html/prob1-1.png" alt="some note" width="100%"><p class="caption">
Figure 7.6: some note
</p>
</div>
<div class="inline-figure"><img src="understanding-nhst_files/figure-html/prob2-1.png" width="100%"></div>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"speed_gender_height"</span>, package <span class="op">=</span> <span class="st">"openintro"</span><span class="op">)</span></span>
<span><span class="va">height_f</span> <span class="op">&lt;-</span> <span class="va">speed_gender_height</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">gender</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>height_cm <span class="op">=</span> <span class="va">height</span> <span class="op">*</span> <span class="fl">2.54</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">height_stat</span> <span class="op">&lt;-</span> <span class="va">height_f</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">height_cm</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">height_cm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">175</span>, mean <span class="op">=</span> <span class="va">height_stat</span><span class="op">$</span><span class="va">m</span>, sd <span class="op">=</span> <span class="va">height_stat</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span> <span class="op">-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">160</span>, mean <span class="op">=</span> <span class="va">height_stat</span><span class="op">$</span><span class="va">m</span>, sd <span class="op">=</span> <span class="va">height_stat</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6111497</span></span></code></pre></div>
</div>
<div id="the-full-statistical-model" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> The Full Statistical Model<a class="anchor" aria-label="anchor" href="#the-full-statistical-model"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"laptop_urry"</span><span class="op">)</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_car</a></span><span class="op">(</span><span class="va">overall</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">pid</span><span class="op">)</span>, <span class="va">laptop_urry</span><span class="op">)</span></span>
<span><span class="co">#&gt; Contrasts set to contr.sum for the following variables: condition</span></span>
<span><span class="va">res1</span></span>
<span><span class="co">#&gt; Anova Table (Type 3 tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: overall</span></span>
<span><span class="co">#&gt;      Effect     df    MSE    F  ges p.value</span></span>
<span><span class="co">#&gt; 1 condition 1, 140 269.66 0.52 .004    .471</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"condition"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  contrast          estimate   SE  df t.ratio p.value</span></span>
<span><span class="co">#&gt;  laptop - longhand     1.99 2.76 140   0.722  0.4715</span></span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/afex_plot.html">afex_plot</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"condition"</span>, data_geom <span class="op">=</span> <span class="fu">ggbeeswarm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_quasirandom.html">geom_quasirandom</a></span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="understanding-nhst_files/figure-html/unnamed-chunk-6-1.png" width="100%"></div>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">laptop_urry</span><span class="op">$</span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">laptop_urry</span><span class="op">)</span></span>
<span><span class="co">#&gt;   pid condition         talk  overall   factual conceptual</span></span>
<span><span class="co">#&gt; 1   1    laptop inequalities 65.83333  61.66667   70.00000</span></span>
<span><span class="co">#&gt; 2   2  longhand inequalities 75.83333  68.33333   83.33333</span></span>
<span><span class="co">#&gt; 3   4  longhand        ideas 50.00000  33.33333   66.66667</span></span>
<span><span class="co">#&gt; 4   5    laptop        islam 89.01099  85.71429   92.30769</span></span>
<span><span class="co">#&gt; 5   6  longhand   algorithms 75.64103  69.23077   82.05128</span></span>
<span><span class="co">#&gt; 6   8  longhand        indus 83.33333 100.00000   66.66667</span></span>
<span><span class="co">#&gt;    residuals</span></span>
<span><span class="co">#&gt; 1  -2.358806</span></span>
<span><span class="co">#&gt; 2   9.632934</span></span>
<span><span class="co">#&gt; 3 -16.200400</span></span>
<span><span class="co">#&gt; 4  20.818850</span></span>
<span><span class="co">#&gt; 5   9.440626</span></span>
<span><span class="co">#&gt; 6  17.132934</span></span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">laptop_urry</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="understanding-nhst_files/figure-html/unnamed-chunk-8-1.png" width="100%"></div>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://gganimate.com">"gganimate"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rvlenth/emmeans">"emmeans"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">res_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">em_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">laptop_urry</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sim"</span>, <span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/LocationScaleT.html">rlst</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">laptop_urry</span><span class="op">)</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">laptop_urry</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, </span>
<span>    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html">sigma</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">res_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"pid"</span>, dv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sim"</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>                         data <span class="op">=</span> <span class="va">laptop_urry</span>, between <span class="op">=</span> <span class="st">"condition"</span><span class="op">)</span></span>
<span>  <span class="va">em_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">res_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="st">"condition"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">em_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sim"</span>, <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim_long</span> <span class="op">&lt;-</span> <span class="va">laptop_urry</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">overall</span>, <span class="va">factual</span>, <span class="va">conceptual</span>, <span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sim"</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"simulation"</span>, values_to <span class="op">=</span> <span class="st">"overall"</span><span class="op">)</span></span>
<span><span class="va">em_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">em_sim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>overall <span class="op">=</span> <span class="va">emmean</span><span class="op">)</span></span>
<span><span class="va">em_diff</span> <span class="op">&lt;-</span> <span class="va">em_sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">overall</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">overall</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">overall</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggbeeswarm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_quasirandom.html">geom_quasirandom</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">em_sim</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    ymax <span class="op">=</span> <span class="va">upper.CL</span>, ymin <span class="op">=</span> <span class="va">lower.CL</span></span>
<span>  <span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">em_diff</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"italic(d) == "</span>, </span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span><span class="op">(</span><span class="va">diff</span>, digits <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                       format <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                x <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, y <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>, </span>
<span>            inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>            <span class="co">#label.padding = unit(0.5, "lines"),</span></span>
<span>            label.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/transition_manual.html">transition_manual</a></span><span class="op">(</span>frames <span class="op">=</span> <span class="va">simulation</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Simulation {frame} of {nframes}'</span><span class="op">)</span></span>
<span><span class="co">#anim_save(filename = "out1.gif", animation = psim1)</span></span>
<span><span class="va">df_ani</span> <span class="op">&lt;-</span> <span class="va">em_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">simulation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/accumulate.html">accumulate</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"simulation"</span><span class="op">)</span> </span>
<span><span class="va">psim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_ani</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, boundary <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/transition_manual.html">transition_manual</a></span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/ease_aes.html">ease_aes</a></span><span class="op">(</span><span class="st">"linear"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/enter_exit.html">enter_fade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/enter_exit.html">exit_fade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Distribution of differences'</span><span class="op">)</span></span>
<span><span class="co">#psim2</span></span></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/">magick</a></span><span class="op">)</span></span>
<span><span class="va">a_gif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span><span class="va">psim1</span>, </span>
<span>                 fps <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                 duration <span class="op">=</span> <span class="va">nsim</span>,</span>
<span>        renderer <span class="op">=</span> <span class="fu"><a href="https://gganimate.com/reference/renderers.html">gifski_renderer</a></span><span class="op">(</span><span class="st">"output/animation1.gif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b_gif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span><span class="va">psim2</span>, </span>
<span>                 fps <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                 duration <span class="op">=</span> <span class="va">nsim</span>,</span>
<span>        renderer <span class="op">=</span> <span class="fu"><a href="https://gganimate.com/reference/renderers.html">gifski_renderer</a></span><span class="op">(</span><span class="st">"output/animation2.gif"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a_mgif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span><span class="op">(</span><span class="va">a_gif</span><span class="op">)</span></span>
<span><span class="va">b_mgif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span><span class="op">(</span><span class="va">b_gif</span><span class="op">)</span></span>
<span><span class="va">new_gif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/animation.html">image_append</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a_mgif</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">b_mgif</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, stack <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/animation.html">image_append</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">a_mgif</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">b_mgif</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, stack <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">new_gif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">new_gif</span>, <span class="va">combined</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/video.html">image_write_gif</a></span><span class="op">(</span><span class="va">new_gif</span>, path <span class="op">=</span> <span class="st">"output/sim1.gif"</span>, delay <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desc_urry</span> <span class="op">&lt;-</span> <span class="va">laptop_urry</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">overall</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">overall</span><span class="op">)</span>, </span>
<span>            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">get_null_dist_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nsim</span>, <span class="va">mean</span>, <span class="va">sd</span>, <span class="va">ns</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/LocationScaleT.html">rlst</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nsim</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, </span>
<span>                        mu <span class="op">=</span> <span class="va">mean</span>, sigma <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span>  <span class="va">group</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">ns</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">nsim</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#browser()</span></span>
<span>  <span class="va">ysplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, f <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span><span class="op">(</span><span class="va">ysplit</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">x</span>, INDEX <span class="op">=</span> <span class="va">group</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         FUN.VALUE <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">nulldist_diff_t</span> <span class="op">&lt;-</span> <span class="fu">get_null_dist_t</span><span class="op">(</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">100000</span>, </span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html">sigma</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span>, </span>
<span>  ns <span class="op">=</span> <span class="va">desc_urry</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#str(nulldist_diff_t)</span></span>
<span><span class="va">full_sim_urry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  diff <span class="op">=</span> <span class="va">nulldist_diff_t</span></span>
<span><span class="op">)</span></span>
<span><span class="va">full_sim_urry</span><span class="op">$</span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nulldist_diff_t</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">df_full_ani</span> <span class="op">&lt;-</span> <span class="va">full_sim_urry</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/accumulate.html">accumulate</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"frame"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hist_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_full_ani</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.2</span>, boundary <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/transition_manual.html">transition_manual</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/ease_aes.html">ease_aes</a></span><span class="op">(</span><span class="st">"linear"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/enter_exit.html">enter_fade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://gganimate.com/reference/enter_exit.html">exit_fade</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">'Distribution of differences'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://gganimate.com/reference/anim_save.html">anim_save</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"output/full_urry.gif"</span>, animation <span class="op">=</span> <span class="va">hist_full</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tp1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">full_sim_urry</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.2</span>, boundary <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tp2</span> <span class="op">&lt;-</span> <span class="va">full_sim_urry</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>side <span class="op">=</span> </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span>, </span>
<span>                         <span class="st">"larger"</span>, <span class="st">"smaller"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diff</span>, fill <span class="op">=</span> <span class="va">side</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.2</span>, boundary <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Color Blind"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">tp1</span>, <span class="va">tp2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_full_ani</span><span class="op">$</span><span class="va">diff</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre></div>
</div>
<div id="what-does-nhst-caclulate" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> What does NHST caclulate?<a class="anchor" aria-label="anchor" href="#what-does-nhst-caclulate"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>

<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("webex-total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("webex-correct").length + " of " +
      document.getElementsByClassName("webex-solveme").length + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }
  
  if (my_answer !== "" & real_answers.includes(my_answer)) {
    cl.add("webex-correct");
  } else {
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);  
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }  
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }  
  }
  
  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }
  
  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off"); 
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";
    
    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;
    
    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  update_total_correct();
}

</script><div class="chapter-nav">
<div class="prev"><a href="standard-approach-exercises.html">Standard Approach for One IV: Quiz and Exercises</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#understanding-nhst"><span class="header-section-number">7</span> Understanding Null-Hypothesis Significance Testing</a></li>
<li><a class="nav-link" href="#the-normal-distribution"><span class="header-section-number">7.1</span> The Normal Distribution</a></li>
<li><a class="nav-link" href="#what-is-probability"><span class="header-section-number">7.2</span> What is Probability?</a></li>
<li><a class="nav-link" href="#the-full-statistical-model"><span class="header-section-number">7.3</span> The Full Statistical Model</a></li>
<li><a class="nav-link" href="#what-does-nhst-caclulate"><span class="header-section-number">7.4</span> What does NHST caclulate?</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/singmann/stats_for_experiments/blob/main/understanding-nhst.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/singmann/stats_for_experiments/edit/main/understanding-nhst.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Statistics for Experimental Psychology with <code>R</code></strong>" was written by Henrik Singmann. It was last built on 2022-10-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
